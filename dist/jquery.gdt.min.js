/*
 * Generic - jQuery Plugin
 *
 * Example and documentation at: http://danlevan.github.io/jquery.generic/
 *
 * Copyright (c) 2014 Dan Le Van
 *
 * Version: 0.1.2 (Thu Nov 13 2014)
 * Requires: jQuery v1.7+
 * * Licensed under the MIT license:
 *   https://raw.github.com/danlevan/jquery.generic/master/LICENSE
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t,n){function s(){if(F.selectedTime=null,F.selectedDate=null,F.options.selectDate&&!isNaN(F.options.selectDate.getTime())){o(F.options.selectDate,"init");var e=F.options.parseEngine.format.call(F.options.parseEngine,F.options.selectDate);F.$el.val(e)}else""!==F.$el.val()&&o(F.$el.val(),"init");F.currentDate=F.selectedDate?new Date(F.selectedDate):F.options.showCalendar}function o(e,t){var n=f(e),s=n?60*n.getHours()+n.getMinutes():null;F.selectedTime!==s&&(F.selectedTime=s,m("selectedTimeChanged",{time:F.selectedTime,context:t}));var o=n;o&&o.setHours(0,0,0,0),F.selectedDate!==o&&(F.selectedDate=o,m("selectedDateChanged",{date:F.selectedDate,context:t}))}function i(){F.$container=e('<div class="'+F.options.css.container+'">'),F.$box=e('<div class="'+F.options.css.box+'">').appendTo(F.$container),F.$close=e('<div class="'+F.options.css.close+'">').appendTo(F.$box),F.$picker=e('<div class="'+F.options.css.picker+'">').appendTo(F.$box),F.$year=e('<div class="'+F.options.css.year+'">').appendTo(F.$picker),F.$month=e('<div class="'+F.options.css.month+'">').appendTo(F.$picker),F.$calendar=e('<div class="'+F.options.css.calendar+'">').appendTo(F.$picker),v(),F.$time=e('<div class="'+F.options.css.time+'">').appendTo(F.$picker),T(),F.$el.addClass(F.options.css.input),F.$container.insertAfter(F.$el)}function a(){e.each(F.options,function(t,n){if(0===t.indexOf("on")&&n){var s=t.substring(2);s=s[0].toLowerCase()+s.slice(1),F.$container.on(s,e.proxy(n,F))}}),F.$close.on("click.gdt",function(e){F.hide(),e.stopImmediatePropagation(),e.preventDefault()}),l(),F.$box.on("click",function(){F.$el.focus()}),F.options.inline||F.$box.on("mouseover.gdt",function(){F.$el.off("blur.gdt",F.hide)}).on("mouseout.gdt",function(){F.$el.on("blur.gdt",F.hide)}),c(),g(),F.$container.on("selectedDateChanged",function(e,t){m("dateSelected",{date:F.selectedDate}),h(t.e)}).on("selectedTimeChanged",function(e,t){m("timeSelected",{time:F.selectedTime,hours:Math.floor(F.selectedTime/60),minutes:F.selectedTime%60,seconds:0,value:F.options.parseEngine.formatTime(Math.floor(F.selectedTime/60),F.selectedTime%60)}),h(t.e)})}function l(){F.options.inline||F.$el.on("focus.gdt",F.show).on("click.gdt",F.show).on("blur.gdt",F.hide),F.$el.on("keyup.gdt",d()),F.$container.on("selectedDateChanged",function(e,t){"input"!==t.context&&D()}).on("selectedTimeChanged",function(e,t){"input"!==t.context&&D()})}function d(){function e(){var e=F.$el.val();n!==e&&(n=e,o(e,"input"))}var t=null,n="";return function(){clearTimeout(t),t=setTimeout(e,F.options.inputParseDelay)}}function c(){F.$year.on("click.gdt","li",r),F.$month.on("click.gdt","li",p),F.$calendar.on("click.gdt","td",u),F.$container.on("selectedDateChanged",function(){F.selectedDate&&!isNaN(F.selectedDate.getTime())&&(F.currentDate=new Date(F.selectedDate)),v(),T()})}function r(){var t=e(this);t.hasClass(F.options.css.outside)||(F.currentDate.setYear(t.data("year")),v())}function p(){var t=e(this);if(!t.hasClass(F.options.css.outside)){var n=t.data("month");F.currentDate.setMonth(n),v(),m("monthSelected",{month:n,value:F.options.parseEngine.i18n.months[n]})}}function u(t){var n=e(this);n.hasClass(F.options.css.outside)||(F.$calendar.find("td."+F.options.css.selected).removeClass(F.options.css.selected),n.addClass(F.options.css.selected),F.selectedDate=new Date(parseInt(n.data("date"))),m("selectedDateChanged",{date:F.selectedDate,context:"popup",e:t}))}function g(){F.$time.on("DOMMouseScroll mousewheel.gb",I).on("click.gdt","li",function(t){var n=e(this);n.hasClass(F.options.css.outside)||(F.$time.find("."+F.options.css.selected).removeClass(F.options.css.selected),n.addClass(F.options.css.selected),F.selectedTime=parseInt(n.data("time")),m("selectedTimeChanged",{time:F.selectedTime,context:"popup",e:t}))}),F.$container.on("selectedTimeChanged",function(e,t){"popup"!==t.context&&T()})}function m(){F.$container&&F.$container.trigger.apply(F.$container,arguments)}function h(e){F.options.inline||F.selectedDate&&F.selectedTime&&(F.$el.focus(),F.hide(),e.stopImmediatePropagation(),e.preventDefault())}function f(e){if("string"==typeof e)try{return F.options.parseEngine.parse.call(F.options.parseEngine,e)}catch(t){return console.error(t),null}return new Date(e)}function D(){if(!F.selectedDate||!F.selectedTime)return void F.$el.val("");var e=new Date(F.selectedDate);null!==F.selectedTime&&e.setHours(0,F.selectedTime);var t=F.options.parseEngine.format.call(F.options.parseEngine,e);F.$el.val(t),F.$el.trigger("change",t),m("change",{value:e})}function v(){F.$calendar.html("").append(b(F.currentDate,F.selectedDate)),F.$year.html("").append(w(F.currentDate)),F.$month.html("").append(y(F.currentDate))}function T(){$(F.selectedTime),F.$time.html("").append(x())}function $(e){F.$time.find("."+F.options.css.selected).removeClass(F.options.css.selected),F.$time.find("li[data-time="+e+"]").addClass(F.options.css.selected)}function C(t,n,s,o){var i=-1,a=-1,l=-1,d=-1;F.options.minDate&&!isNaN(F.options.minDate.getTime())&&(i=F.options.minDate.getFullYear(),a=F.options.minDate.getMonth(),l=F.options.minDate.getDate(),d=60*F.options.minDate.getHours()+F.options.minDate.getMinutes());var c=1/0,r=1/0,p=1/0,u=-1;F.options.maxDate&&!isNaN(F.options.maxDate.getTime())&&(c=F.options.maxDate.getFullYear(),r=F.options.maxDate.getMonth(),p=F.options.maxDate.getDate(),u=60*F.options.minDate.getHours()+F.options.minDate.getMinutes());var g=!1;if(g|=i>t,g|=t>c,void 0!==n&&(g|=i===t&&a>n,g|=c===t&&n>r),void 0!==s&&(g|=i===t&&a===n&&l>s,g|=c===t&&r===n&&s>p),void 0!==o&&(g|=i===t&&a===n&&l===s&&d>o,g|=c===t&&r===n&&p===s&&o>u),void 0!==n&&void 0!==s&&F.options.disabledDates)if(F.options.disabledDates instanceof Date)g|=h.getFullYear()===t&&h.getMonth()===n&&h.getDate()===s;else if(e.isFunction(F.options.disabledDates))g|=F.options.disabledDates.call(this,t,n,s,o);else if(F.options.disabledDates instanceof Array)for(var m=0;m<F.options.disabledDates.length;m++){var h=F.options.disabledDates[m];g|=h.getFullYear()===t&&h.getMonth()===n&&h.getDate()===s}return g}function w(t){for(var n=new Date(t),s=n.getFullYear(),o=e("<ol>"),i=s-F.options.yearsBefore;i<=s+F.options.yearsAfter;i++){var a=e("<li>").data("year",i).html(i).appendTo(o);s===i&&a.addClass(F.options.css.selected),C(i)&&a.addClass(F.options.css.outside)}return o}function y(t){for(var n=new Date(t),s=n.getMonth(),o=e("<ol>"),i=0;12>i;i++){var a=e("<li>").data("month",i).html(F.options.parseEngine.i18n.months[i]).appendTo(o);s===i&&a.addClass(F.options.css.selected),C(n.getFullYear(),i)&&a.addClass(F.options.css.outside)}return o}function b(t,n){var s=new Date(t),o=s.getMonth(),i=s.getYear();s.setDate(1),s.setDate(1-s.getDay()),s.setHours(0,0,0,0);var a=new Date;a.setHours(0,0,0,0);for(var l=e("<table>"),d=e("<tr>").appendTo(l),c=0;7>c;c++)e("<th>").html(F.options.parseEngine.i18n.days[c]).appendTo(d);for(var r=0;6>r;r++)for(var p=e("<tr>").appendTo(l),u=0;6>=u;u++){var g=e("<td>").appendTo(p);(s.getMonth()!==o||s.getYear()!==i)&&g.addClass(F.options.css["outside-month"]),n&&s.getTime()===n.getTime()&&g.addClass(F.options.css.selected),C(s.getFullYear(),s.getMonth(),s.getDate())?g.addClass(F.options.css.outside):s.getTime()===a.getTime()&&g.addClass(F.options.css.today),g.data("date",s.getTime()),g.html("<span>"+s.getDate()+"</span>"),s.setDate(s.getDate()+1)}return l}function x(){for(var t=e("<ol>"),n=0;1440>n;){var s=e("<li>").data("time",n).attr("data-time",n).html(F.options.parseEngine.formatTime.call(F.options.parseEngine,Math.floor(n/60),n%60)).appendTo(t);F.selectedTime===n&&s.addClass(F.options.css.selected),F.selectedDate&&C(F.selectedDate.getFullYear(),F.selectedDate.getMonth(),F.selectedDate.getDate(),n)&&s.addClass(F.options.css.outside),n+=F.options.showIntervalTime}return t}function M(e){switch(e.keyCode){case Y.ESC:F.hide(),e.stopImmediatePropagation(),e.preventDefault();break;case Y.TAB:F.hide()}}function k(e){e||(e=F.selectedTime);var t=F.$time.find("li[data-time="+e+"]");if(t.length>0){var n=t.position().top+F.$time.scrollTop()-F.$time.position().top-F.$time.outerHeight()/2+t.outerHeight()/2;F.$time.scrollTop(n)}}function E(e){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1}function I(t){var n=e(this),s=this.scrollTop,o=this.scrollHeight,i=n.height(),a=t.originalEvent.wheelDelta,l=parseInt(n.css("paddingTop"))||0,d=parseInt(n.css("paddingTop"))||0,c=a>0;return!c&&-a>o-i-s-l-d?(n.scrollTop(o),E(t)):c&&a>s?(n.scrollTop(0),E(t)):void 0}function S(){try{{window.getComputedStyle(F.$container[0]).visibility}}catch(e){}}var F=this;F.$el=e(t),F.isVisible=!1,this.options=e.extend(!0,{},e.fn.gdt.defaults,n),s(),i(),S(),F.show=function(){return F.isVisible?void 0:(F.$container.addClass(F.options.css.visible),k(null!==F.selectedTime?F.selectedTime:F.options.showTime),F.options.hideOnEsc&&e(window).on("keydown.gdt",F,M),F.isVisible=!0,m("show"),F)},this.hide=function(){return F.isVisible?(F.options.hideOnEsc&&e(window).off("keydown.gdt"),F.$container.removeClass(F.options.css.visible),F.isVisible=!1,m("hide"),F):void 0},this.selectDate=function(e){return o(e),F};var Y={ESC:27,TAB:9};a(),m("initialize"),F.options.inline&&F.show()}e.fn.gdt=function(n){var s="_gdt",o=(e(this.first()),this.map(function(){var o=e(this),i=o.data(s);if(i)return i;var a=o.data("gdt");return"string"==typeof a&&(console.warn("The data-options provided is not a valid JSON: "+a),a={}),i=new t(o[0],e.extend(!0,{},a?a:{},n?n:{})),o.data(s,i),i}));return 1===o.length?o[0]:o},e.fn.gdt.defaults={css:{input:"gdt-input",container:"gdt-container",box:"gdt-box",close:"gdt-close",picker:"gdt-picker",year:"gdt-year",month:"gdt-month",calendar:"gdt-calendar",time:"gdt-time",visible:"visible",outside:"outside","outside-month":"outside-month",selected:"selected",today:"today"},hideOnEsc:!0,inline:!1,selectDate:null,minDate:null,maxDate:null,disabledDates:[],inputParseDelay:500,showCalendar:new Date,showTime:480,showIntervalTime:30,yearsBefore:2,yearsAfter:2,onChange:null,onDateSelected:null,onTimeSelected:null,onInitialize:null,parseEngine:{i18n:{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},format:function(e){var t=e.getMonth()+1,n=e.getDate();return e.getFullYear()+"/"+(10>t?"0":"")+t+"/"+(10>n?"0":"")+n+" "+this.formatTime(e.getHours(),e.getMinutes())},formatTime:function(e,t){return(e%12===0?12:e%12)+":"+(10>t?"0":"")+t+(e>=12?"PM":"AM")},parse:function(e){var t=e.split(" "),n=t[0].split("/"),s=n.length>0?parseInt(n[0]):0/0,o=n.length>1?parseInt(n[1])-1:0/0,i=(n.length>2?parseInt(n[2]):0/0)||1,a=0,l=0;if(t.length>1){var d=t[1].split(":");a=(d.length>0?parseInt(d[0]):0/0)||0,l=(d.length>1?parseInt(d[1]):0/0)||0,d.length>0&&12>a&&d[Math.min(d.length-1,1)].toLowerCase().indexOf("pm")>=0&&(a+=12)}return new Date(s,o,i,a,l)}}}});
//# sourceMappingURL=jquery.gdt.min.js.map