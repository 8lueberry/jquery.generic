/*
 * Generic - jQuery Plugin
 *
 * Example and documentation at: http://danlevan.github.io/jquery.generic
 *
 * Copyright (c) 2014 Dan LE VAN
 *
 * Version: 0.1.2 (Thu Nov 06 2014)
 * Requires: jQuery v1.7+
 * * Licensed under the MIT license:
 *   https://raw.github.com/danlevan/jquery.generic/master/LICENSE
 */

!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(b,c){function d(){G.selectedTime=null,G.selectedDate=null,G.options.selectDate?e(G.options.selectDate,"init"):""!==G.$el.val()&&e(G.$el.val(),"init"),G.currentDate=G.selectedDate?new Date(G.selectedDate):G.options.showCalendar}function e(a,b){var c=r(a),d=c?60*c.getHours()+c.getMinutes():null;G.selectedTime!==d&&(G.selectedTime=d,p("selectedTimeChanged",{time:G.selectedTime,context:b}));var e=c;e&&e.setHours(0,0,0,0),G.selectedDate!==e&&(G.selectedDate=e,p("selectedDateChanged",{date:G.selectedDate,context:b}))}function f(){G.$container=a('<div class="'+G.options.css.container+'">'),G.$box=a('<div class="'+G.options.css.box+'">').appendTo(G.$container),G.$close=a('<div class="'+G.options.css.close+'">').appendTo(G.$box),G.$calendarYearContainer=a('<div class="'+G.options.css.calendar.year+'">').appendTo(G.$box),G.$calendarMonthContainer=a('<div class="'+G.options.css.calendar.month+'">').appendTo(G.$box),G.$helperContainer=a('<div class="'+G.options.css.helper.container+'">').html('<ul><li class="today"><button>Today</button></li><li class="tomorrow"><button>Tomorrow</button></li><li class="next-week"><button>Next week</button></li><li class="next-month"><button>Next month</button></li><li class="next-year"><button>Next year</button></li></ul>').appendTo(G.$box),G.$calendarContainer=a('<div class="'+G.options.css.calendar.container+'">').appendTo(G.$box),t(),G.$timeContainer=a('<div class="'+G.options.css.time.container+'">').appendTo(G.$box),u(),G.$el.addClass(G.options.css.input),G.$container.insertAfter(G.$el)}function g(){a.each(G.options,function(a,b){if(0===a.indexOf("on")){var c=a.substring(2);c=c[0].toLowerCase()+c.slice(1),G.$container.on(c,b)}}),G.$close.on("click.gdt",G.hide),h(),G.options.inline||G.$box.on("mouseover.gdt",function(){G.$el.off("blur.gdt",G.hide)}).on("mouseout.gdt",function(){G.$el.on("blur.gdt",G.hide)}),j(),n(),G.$container.on("selectedDateChanged",q).on("selectedTimeChanged",q),o()}function h(){G.options.inline||G.$el.on("focus.gdt",G.show).on("click.gdt",G.show).on("blur.gdt",G.hide),G.$el.on("keyup.gdt",i()),G.$container.on("selectedDateChanged",function(a,b){"input"!==b.context&&s()}).on("selectedTimeChanged",function(a,b){"input"!==b.context&&s()})}function i(){function a(){var a=G.$el.val();c!==a&&(c=a,e(a,"input"))}var b=null,c="";return function(){clearTimeout(b),b=setTimeout(a,G.options.inputParseDelay)}}function j(){G.$calendarYearContainer.on("DOMMouseScroll mousewheel.gb",D).on("click.gdt","li",k),G.$calendarMonthContainer.on("DOMMouseScroll mousewheel.gb",D).on("click.gdt","li",l),G.$calendarContainer.on("DOMMouseScroll mousewheel.gb",D).on("click.gdt","td",m),G.$container.on("selectedDateChanged",function(){G.selectedDate&&!isNaN(G.selectedDate.getTime())&&(G.currentDate=new Date(G.selectedDate)),t(),u()})}function k(){var b=a(this);b.hasClass(G.options.css.outside)||(G.currentDate.setYear(b.data("year")),t())}function l(){var b=a(this);b.hasClass(G.options.css.outside)||(G.currentDate.setMonth(b.data("month")),t())}function m(){var b=a(this);b.hasClass(G.options.css.outside)||(G.$calendarContainer.find("td."+G.options.css.selected).removeClass(G.options.css.selected),b.addClass(G.options.css.selected),G.selectedDate=new Date(parseInt(b.data("date"))),p("selectedDateChanged",{date:G.selectedDate,context:"popup"}),p("dateSelected",G.selectedDate))}function n(){G.$timeContainer.on("DOMMouseScroll mousewheel.gb",E).on("click.gdt","li",function(){var b=a(this);b.hasClass(G.options.css.outside)||(G.$timeContainer.find("."+G.options.css.selected).removeClass(G.options.css.selected),b.addClass(G.options.css.selected),G.selectedTime=parseInt(b.data("time")),p("selectedTimeChanged",{time:G.selectedTime,context:"popup"}),p("timeSelected",G.selectedTime))}),G.$container.on("selectedTimeChanged",function(a,b){"popup"!==b.context&&u()})}function o(){function a(a,b,c){return function(){var d=new Date;a&&d.setDate(d.getDate()+a),b&&d.setMonth(d.getMonth()+b),c&&d.setFullYear(d.getFullYear()+c),d.setHours(0,0,0,0),e(d,"helper")}}G.$helperContainer.on("click.gdt","li.today button",a(0)).on("click.gdt","li.tomorrow button",a(1)).on("click.gdt","li.next-week button",a(7)).on("click.gdt","li.next-month button",a(null,1)).on("click.gdt","li.next-year button",a(null,null,1))}function p(){G.$container&&G.$container.trigger.apply(G.$container,arguments)}function q(){G.options.inline||G.selectedDate&&G.selectedTime&&(G.$el.focus(),G.hide())}function r(a){if("string"==typeof a)try{return G.options.parseEngine.parse.call(G.options.parseEngine,a)}catch(b){return console.error(b),null}return new Date(a)}function s(){if(!G.selectedDate||!G.selectedTime)return void G.$el.val("");var a=new Date(G.selectedDate);null!==G.selectedTime&&a.setHours(0,G.selectedTime);var b=G.options.parseEngine.format.call(G.options.parseEngine,a);G.$el.val(b),G.$el.trigger("change",b),p("change",a)}function t(){G.$calendarContainer.html("").append(z(G.currentDate,G.selectedDate)),G.$calendarYearContainer.html("").append(x(G.currentDate)),G.$calendarMonthContainer.html("").append(y(G.currentDate))}function u(){v(G.selectedTime),G.$timeContainer.html("").append(A())}function v(a){G.$timeContainer.find("."+G.options.css.selected).removeClass(G.options.css.selected),G.$timeContainer.find("li[data-time="+a+"]").addClass(G.options.css.selected)}function w(b,c,d,e){var f=-1,g=-1,h=-1,i=-1;G.options.minDate&&!isNaN(G.options.minDate.getTime())&&(f=G.options.minDate.getFullYear(),g=G.options.minDate.getMonth(),h=G.options.minDate.getDate(),i=60*G.options.minDate.getHours()+G.options.minDate.getMinutes());var j=1/0,k=1/0,l=1/0,m=-1;G.options.maxDate&&!isNaN(G.options.maxDate.getTime())&&(j=G.options.maxDate.getFullYear(),k=G.options.maxDate.getMonth(),l=G.options.maxDate.getDate(),m=60*G.options.minDate.getHours()+G.options.minDate.getMinutes());var n=!1;if(n|=f>b,n|=b>j,void 0!==c&&(n|=f===b&&g>c,n|=j===b&&c>k),void 0!==d&&(n|=f===b&&g===c&&h>d,n|=j===b&&k===c&&d>l),void 0!==e&&(n|=f===b&&g===c&&h===d&&i>e,n|=j===b&&k===c&&l===d&&e>m),void 0!==c&&void 0!==d&&G.options.disabledDates)if(G.options.disabledDates instanceof Date)n|=p.getFullYear()===b&&p.getMonth()===c&&p.getDate()===d;else if(a.isFunction(G.options.disabledDates))n|=G.options.disabledDates.call(this,b,c,d,e);else if(G.options.disabledDates instanceof Array)for(var o=0;o<G.options.disabledDates.length;o++){var p=G.options.disabledDates[o];n|=p.getFullYear()===b&&p.getMonth()===c&&p.getDate()===d}return n}function x(b){for(var c=new Date(b),d=c.getFullYear(),e=a("<ol>"),f=d-G.options.yearsBefore;f<=d+G.options.yearsAfter;f++){var g=a("<li>").data("year",f).html(f).appendTo(e);d===f&&g.addClass(G.options.css.selected),w(f)&&g.addClass(G.options.css.outside)}return e}function y(b){for(var c=new Date(b),d=c.getMonth(),e=a("<ol>"),f=0;12>f;f++){var g=a("<li>").data("month",f).html(G.options.parseEngine.i18n.months[f]).appendTo(e);d===f&&g.addClass(G.options.css.selected),w(c.getFullYear(),f)&&g.addClass(G.options.css.outside)}return e}function z(b,c){var d=new Date(b),e=d.getMonth(),f=d.getYear();d.setDate(1),d.setDate(1-d.getDay()),d.setHours(0,0,0,0);var g=new Date;g.setHours(0,0,0,0);for(var h=a("<table>"),i=a("<tr>").appendTo(h),j=0;7>j;j++)a("<th>").html(G.options.parseEngine.i18n.days[j]).appendTo(i);for(var k=0;6>k;k++)for(var l=a("<tr>").appendTo(h),m=0;6>=m;m++){var n=a("<td>").appendTo(l);(d.getMonth()!==e||d.getYear()!==f)&&n.addClass(G.options.css.calendar["outside-month"]),c&&d.getTime()===c.getTime()&&n.addClass(G.options.css.selected),w(d.getFullYear(),d.getMonth(),d.getDate())?n.addClass(G.options.css.outside):d.getTime()===g.getTime()&&n.addClass(G.options.css.today),n.data("date",d.getTime()),n.html("<span>"+d.getDate()+"</span>"),d.setDate(d.getDate()+1)}return h}function A(){for(var b=a("<ol>"),c=0;1440>c;){var d=a("<li>").data("time",c).attr("data-time",c).html(G.options.parseEngine.formatTime.call(G.options.parseEngine,Math.floor(c/60),c%60)).appendTo(b);G.selectedTime===c&&d.addClass(G.options.css.selected),G.selectedDate&&w(G.selectedDate.getFullYear(),G.selectedDate.getMonth(),G.selectedDate.getDate(),c)&&d.addClass(G.options.css.outside),c+=G.options.showIntervalTime}return b}function B(a){switch(a.keyCode){case H.ESC:G.hide(),a.stopImmediatePropagation(),a.preventDefault();break;case H.TAB:G.hide()}}function C(a){var b=G.$timeContainer.find("li[data-time="+a+"]");if(b.length>0){var c=b.position().top+G.$timeContainer.scrollTop()-G.$timeContainer.position().top-G.$timeContainer.outerHeight()/2+b.outerHeight()/2;G.$timeContainer.scrollTop(c)}}function D(a){return a.stopPropagation(),a.preventDefault(),a.returnValue=!1,!1}function E(b){var c=a(this),d=this.scrollTop,e=this.scrollHeight,f=c.height(),g=b.originalEvent.wheelDelta,h=parseInt(c.css("paddingTop"))||0,i=parseInt(c.css("paddingTop"))||0,j=g>0;return!j&&-g>e-f-d-h-i?(c.scrollTop(e),D(b)):j&&g>d?(c.scrollTop(0),D(b)):void 0}function F(){try{{window.getComputedStyle(G.$container[0]).visibility}}catch(a){}}var G=this;G.$el=a(b),G.isVisible=!1,this.options=a.extend(!0,{},a.fn.gdt.defaults,c),d(),f(),F(),G.show=function(){return G.isVisible?void 0:(G.$container.addClass(G.options.css.visible),C(null!==G.selectedTime?G.selectedTime:G.options.showTime),G.options.hideOnEsc&&a(window).on("keydown.gdt",G,B),G.isVisible=!0,p("show"),G)},this.hide=function(){return G.isVisible?(G.options.hideOnEsc&&a(window).off("keydown.gdt",G,B),G.$container.removeClass(G.options.css.visible),G.isVisible=!1,p("hide"),G):void 0},this.selectDate=function(a){return e(a),G};var H={ESC:27,TAB:9};g(),p("initialize"),G.options.inline&&G.show()}a.fn.gdt=function(c){var d="_gdt",e=(a(this.first()),this.map(function(){var e=a(this),f=e.data(d);if(f)return f;var g=e.data("gdt");return"string"==typeof g&&(console.warn("The data-options provided is not a valid JSON: "+g),g={}),f=new b(e[0],a.extend(!0,{},g?g:{},c?c:{})),e.data(d,f),f}));return 1===e.length?e[0]:e},a.fn.gdt.defaults={css:{input:"gdt-input",container:"gdt-container",box:"gdt-box",close:"gdt-close",visible:"visible",outside:"outside",selected:"selected",today:"today",calendar:{container:"gdt-calendar",year:"gdt-year",month:"gdt-month","outside-month":"outside-month"},time:{container:"gdt-time"},helper:{container:"gdt-helper"}},hideOnEsc:!0,inline:!1,selectDate:null,minDate:null,maxDate:null,disabledDates:[],inputParseDelay:500,showCalendar:new Date,showTime:480,showIntervalTime:30,yearsBefore:2,yearsAfter:2,onChange:null,onDateSelected:null,onTimeSelected:null,parseEngine:{i18n:{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},format:function(a){var b=a.getMonth()+1,c=a.getDate();return a.getFullYear()+"/"+(10>b?"0":"")+b+"/"+(10>c?"0":"")+c+" "+this.formatTime(a.getHours(),a.getMinutes())},formatTime:function(a,b){return(a%12===0?12:a%12)+":"+(10>b?"0":"")+b+(a>=12?"PM":"AM")},parse:function(a){var b=a.split(" "),c=b[0].split("/"),d=c.length>0?parseInt(c[0]):0/0,e=c.length>1?parseInt(c[1])-1:0/0,f=(c.length>2?parseInt(c[2]):0/0)||1,g=0,h=0;if(b.length>1){var i=b[1].split(":");g=(i.length>0?parseInt(i[0]):0/0)||0,h=(i.length>1?parseInt(i[1]):0/0)||0,i.length>0&&12>g&&i[Math.min(i.length-1,1)].toLowerCase().indexOf("pm")>=0&&(g+=12)}return new Date(d,e,f,g,h)}}}});
//# sourceMappingURL=jquery.genericDateTimePicker.min.js.map